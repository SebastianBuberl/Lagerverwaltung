<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lagerplatz LED Ausgabe</title>
    <style>
        .lagerplatz {
            font-size: 20px;
            display: flex;  
            width: 40px;
            height: 40px;
            border-radius: 50%;
            gap: 12px;
            border: 1.5px solid #000;
            justify-content: center;
            align-items: center;
            color: white;
            text-shadow: 
            -1px -1px 0px #000,
             0px -1px 0px #000,
             1px -1px 0px #000,
            -1px  0px 0px #000,
             1px  0px 0px #000,
            -1px  1px 0px #000,
             0px  1px 0px #000,
             1px  1px 0px #000;
            margin: 10px;
        }

        .output-container {
            display: flex;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <h1>Lagerplatz LED Ausgabe</h1>

    
    <!-- Input für das Hochladen der JSON-Datei -->
    <input type="file" id="fileInput" accept=".json" /> 

    <div id="output" class="output-container"></div>

    <script>
        let PersonalDaten = []; // Initialisierung für PersonalDaten

        // Event-Listener für die Datei-Auswahl
        document.getElementById("fileInput").addEventListener("change", function(event) {
            const file = event.target.files[0];
            if (file && file.name.endsWith('.json')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // JSON-Daten laden
                        const data = JSON.parse(e.target.result);
                        PersonalDaten = data; // Die hochgeladenen Daten setzen
                        alert("JSON-Datei erfolgreich geladen!");
                        anzeigen();
                    } catch (error) {
                        alert("Fehler beim Verarbeiten der JSON-Datei.");
                    }
                };
                reader.readAsText(file);
            } else {
                alert("Bitte eine gültige JSON-Datei hochladen.");
            }
        });

        const farben = [
            {"name": "Rot", "rgb": "rgb(255, 0, 0)"},
            {"name": "Blau", "rgb": "rgb(0, 0, 255)"},
            {"name": "Grün", "rgb": "rgb(0, 255, 0)"},
            {"name": "Gelb", "rgb": "rgb(255, 255, 0)"},
            {"name": "Orange", "rgb": "rgb(255, 165, 0)"},
            {"name": "Lila", "rgb": "rgb(128, 0, 128)"},
            {"name": "Türkis", "rgb": "rgb(64, 224, 208)"},
            {"name": "Pink", "rgb": "rgb(255, 105, 180)"},
            {"name": "Braun", "rgb": "rgb(165, 42, 42)"},
            {"name": "Grau", "rgb": "rgb(128, 128, 128)"},
            {"name": "Hellgrün", "rgb": "rgb(144, 238, 144)"},
            {"name": "Dunkelblau", "rgb": "rgb(0, 0, 139)"},
            {"name": "Violett", "rgb": "rgb(238, 130, 238)"},
            {"name": "Hellblau", "rgb": "rgb(173, 216, 230)"},
            {"name": "Beige", "rgb": "rgb(245, 245, 220)"},
            {"name": "Dunkelrot", "rgb": "rgb(139, 0, 0)"},
            {"name": "Hellbraun", "rgb": "rgb(205, 133, 63)"},
            {"name": "Hellgelb", "rgb": "rgb(255, 255, 102)"},
            {"name": "Magenta", "rgb": "rgb(255, 0, 255)"},
            {"name": "Dunkelgrün", "rgb": "rgb(0, 100, 0)"},
            {"name": "Cyan", "rgb": "rgb(0, 255, 255)"},
            {"name": "Zinnober", "rgb": "rgb(227, 66, 52)"},
            {"name": "Mintgrün", "rgb": "rgb(189, 252, 201)"},
            {"name": "Blaugrün", "rgb": "rgb(0, 128, 128)"},
            {"name": "Pfirsich", "rgb": "rgb(255, 218, 185)"}
        ];

        // Füge den Personen Farben hinzu
        function addColorsToData() {
            PersonalDaten.forEach((person, index) => {
                person.farbe = farben[index] ? farben[index].rgb : "rgb(0,0,0)";  // RGB-Wert
                person.farbeName = farben[index] ? farben[index].name : "Unbekannt";  // Farbname
            });
        }

        // Funktion, die die Ausgabe erstellt
        function anzeigen() {
            if (PersonalDaten.length > 0) {
                addColorsToData();

                // Finde alle Lagerplätze, die 6 oder weniger Personen haben
                const lagerplaetze = PersonalDaten.reduce((acc, person) => {
                    person.lagerplätze.forEach(lagerplatz => {
                        if (!acc[lagerplatz]) {
                            acc[lagerplatz] = [];
                        }
                        acc[lagerplatz].push(person);
                    });
                    return acc;
                }, {});

                const outputDiv = document.getElementById("output");
                outputDiv.innerHTML = "";

                Object.keys(lagerplaetze).forEach(lagerplatz => {
                    const anzahlPersonen = lagerplaetze[lagerplatz].length;
                    if (anzahlPersonen <= 6) {
                        const letztePerson = lagerplaetze[lagerplatz][lagerplaetze[lagerplatz].length - 1];
                        outputDiv.innerHTML += `<div class="lagerplatz" style="background-color: ${letztePerson.farbe};">${lagerplatz}</div>`;
                    }
                });
            }
        }
    </script>
</body>
</html>
